#!/usr/bin/env bash

# Source pnpm resolution logic
. "$(dirname "$0")/pnpm-env.sh"

# Run secret scan (non-fatal if gitleaks missing) + lint-staged
pnpm run precommit:secrets || echo "⚠️  precommit:secrets skipped/failed"
# Prefer pnpm dlx; fallback to npx if pnpm still unavailable
if command -v pnpm >/dev/null 2>&1; then
  pnpm dlx lint-staged
else
  npx --yes lint-staged
fi
